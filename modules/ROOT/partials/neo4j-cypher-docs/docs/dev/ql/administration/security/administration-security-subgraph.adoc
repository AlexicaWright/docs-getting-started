[[administration-security-subgraph]]
= Graph and sub-graph access control

[abstract]
--
This section explains how to use Cypher to manage privileges for Neo4j role-based access control and fine-grained security.
--


* <<administration-security-subgraph-introduction, The `GRANT`, `DENY` and `REVOKE` commands>>
* <<administration-security-subgraph-show, Listing privileges>>
** <<administration-security-subgraph-show-all, Examples for listing all privileges>>
** <<administration-security-subgraph-show-roles, Examples for listing privileges for specific roles>>
** <<administration-security-subgraph-show-users, Examples for listing privileges for specific users>>
* <<administration-security-subgraph-revoke, The `REVOKE` command>>



Privileges control the access rights to graph elements using a combined whitelist/blacklist mechanism.
It is possible to grant access, or deny access, or a combination of the two.
The user will be able to access the resource if they have a grant (whitelist) and do not have a deny (blacklist) relevant to that resource.
All other combinations of `GRANT` and `DENY` will result in the matching path being inaccessible.
What this means in practice depends on whether we are talking about a <<administration-security-reads, read privilege>> or a <<administration-security-writes, write privilege>>.

* If a entity is not accessible due to <<administration-security-reads, read privileges>>, the data will become invisible to attempts to read it.
  It will appear to the user as if they have a smaller database (smaller graph).
* If an entity is not accessible due to <<administration-security-writes, write privileges>>, an error will occur on any attempt to write that data.


[NOTE]
====
In this document we will often use the terms _'allows'_ and _'enables'_ in seemingly identical ways. However, there is a subtle difference.
We will use _'enables'_ to refer to the consequences of <<administration-security-reads, read privileges>> where a restriction will not cause an error,
only a reduction in the apparent graph size. We will use _'allows'_ to refer to the consequence of <<administration-security-writes, write privileges>>
where a restriction can result in an error.



====

[NOTE]
====
If a user was not also provided with the database `ACCESS` privilege then access to the entire database will be denied.
Information about the database access privilege can be found in <<administration-security-administration-database-access, The ACCESS privilege>>.



====

[role=enterprise-edition]
[[administration-security-subgraph-introduction]]
== The `GRANT`, `DENY` and `REVOKE` commands

include::grant-deny-syntax.adoc[]

The general grant and deny syntax is illustrated in the image below.

image::grant-privileges-overview.png[title="GRANT and DENY Syntax"]

A more detailed syntax illustration would be the image below for graph privileges.

image::grant-privileges-graph.png[title="Syntax of GRANT and DENY Graph Privileges. The `{` and `}` are part of the syntax and not used for grouping."]

The below image shows the hierarchy between the different graph privileges.

image::privilege-hierarchy-graph.png[title="Graph privileges hierarchy"]

[role=enterprise-edition]
[[administration-security-subgraph-show]]
== Listing privileges

Available privileges can be displayed using the different `SHOW PRIVILEGES` commands.

include::show-privileges-syntax.adoc[]

When using the `RETURN` clause, the `YIELD` clause is mandatory and may not be omitted.

For an easy overview of the existing privileges, it is recommended to use the `AS COMMANDS` version of the show command.
This returns the privileges as the commands that are granted or denied.

Omitting the `AS COMMANDS` clause instead gives the result as multiple columns describing the privilege:

* `access`: whether the privilege is granted or denied
* `action`: which type of privilege this is, for example traverse, read, index management, or role management
* `resource`: what type of scope this privilege applies to: the entire dbms, a database, a graph or sub-graph access
* `graph`: the specific database or graph this privilege applies to
* `segment`: when applicable, the scope this privilege applies to: labels, relationship types, procedures, functions, or transactions
* `role`: the role the privilege is granted to


[[administration-security-subgraph-show-all]]
=== Examples for listing all privileges

Available privileges for all roles can be displayed using `SHOW PRIVILEGES`.

include::show-all-privileges-syntax.adoc[]


.Query
[source, cypher]
----
SHOW PRIVILEGES
----

Lists all privileges for all roles.

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"FUNCTION(*)"+ | +"PUBLIC"+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"PROCEDURE(*)"+ | +"PUBLIC"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"DEFAULT"+ | +"database"+ | +"PUBLIC"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"admin"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"admin"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"admin"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"admin"+
| +"GRANTED"+ | +"transaction_management"+ | +"database"+ | +"*"+ | +"USER(*)"+ | +"admin"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"constraint"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"dbms_actions"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"index"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"start_database"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"stop_database"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"token"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"architect"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"architect"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"architect"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"architect"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"architect"+
| +"GRANTED"+ | +"constraint"+ | +"database"+ | +"*"+ | +"database"+ | +"architect"+
| +"GRANTED"+ | +"index"+ | +"database"+ | +"*"+ | +"database"+ | +"architect"+
| +"GRANTED"+ | +"token"+ | +"database"+ | +"*"+ | +"database"+ | +"architect"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"editor"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"editor"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"editor"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"editor"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"editor"+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"noAccessUsers"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"publisher"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"publisher"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"publisher"+
| +"GRANTED"+ | +"write"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"publisher"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"publisher"+
| +"GRANTED"+ | +"token"+ | +"database"+ | +"*"+ | +"database"+ | +"publisher"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"reader"+
| +"GRANTED"+ | +"match"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"reader"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"reader"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 39
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

It is also possible to filter and sort the results by using `YIELD`, `ORDER BY` and `WHERE`.


.Query
[source, cypher]
----
SHOW PRIVILEGES YIELD role, access, action, segment ORDER BY action WHERE role = 'admin' 
----

In this example:

* The number of columns returned has been reduced with the `YIELD` clause.
* The order of the returned columns has been changed.
* The results have been filtered to only return the `admin` role using a `WHERE` clause.
* The results are ordered by the `action` column using `ORDER BY`.

`SKIP` and `LIMIT` can also be used to paginate the results.


.Result
[role="queryresult",options="header,footer",cols="4*<m"]
|===
| +role+ | +access+ | +action+ | +segment+
| +"admin"+ | +"GRANTED"+ | +"access"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"constraint"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"dbms_actions"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"index"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"match"+ | +"NODE(*)"+
| +"admin"+ | +"GRANTED"+ | +"match"+ | +"RELATIONSHIP(*)"+
| +"admin"+ | +"GRANTED"+ | +"start_database"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"stop_database"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"token"+ | +"database"+
| +"admin"+ | +"GRANTED"+ | +"transaction_management"+ | +"USER(*)"+
| +"admin"+ | +"GRANTED"+ | +"write"+ | +"NODE(*)"+
| +"admin"+ | +"GRANTED"+ | +"write"+ | +"RELATIONSHIP(*)"+
4+d|Rows: 12
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES YIELD role, access, action, segment ORDER BY action WHERE role = 'admin' 
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

`WHERE` can be used without `YIELD`


.Query
[source, cypher]
----
SHOW PRIVILEGES WHERE graph <> '*' 
----

In this example, the `WHERE` clause is used to filter privileges down to those that target specific graphs only.

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +graph+ | +resource+ | +role+ | +segment+
| +"GRANTED"+ | +"access"+ | +"DEFAULT"+ | +"database"+ | +"PUBLIC"+ | +"database"+
| +"DENIED"+ | +"access"+ | +"neo4j"+ | +"database"+ | +"noAccessUsers"+ | +"database"+
| +"GRANTED"+ | +"access"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+ | +"database"+
6+d|Rows: 3
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES WHERE graph <> '*' 
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Aggregations in the `RETURN` clause can be used to group privileges. In this case, by user and granted / denied.


.Query
[source, cypher]
----
SHOW PRIVILEGES YIELD * RETURN role, access, collect([graph, resource, segment, action]) as privileges
----

.Result
[role="queryresult",options="header,footer",cols="3*<m"]
|===
| +role+ | +access+ | +privileges+
| +"PUBLIC"+ | +"GRANTED"+ | +[["*","database","FUNCTION(*)","execute"],["*","database","PROCEDURE(*)","execute"],["DEFAULT","database","database","access"]]+
| +"admin"+ | +"GRANTED"+ | +[["*","all_properties","NODE(*)","match"],["*","graph","NODE(*)","write"],["*","all_properties","RELATIONSHIP(*)","match"],["*","graph","RELATIONSHIP(*)","write"],["*","database","USER(*)","transaction_management"],["*","database","database","access"],["*","database","database","constraint"],["*","database","database","dbms_actions"],["*","database","database","index"],["*","database","database","start_database"],["*","database","database","stop_database"],["*","database","database","token"]]+
| +"architect"+ | +"GRANTED"+ | +[["*","all_properties","NODE(*)","match"],["*","graph","NODE(*)","write"],["*","all_properties","RELATIONSHIP(*)","match"],["*","graph","RELATIONSHIP(*)","write"],["*","database","database","access"],["*","database","database","constraint"],["*","database","database","index"],["*","database","database","token"]]+
| +"editor"+ | +"GRANTED"+ | +[["*","all_properties","NODE(*)","match"],["*","graph","NODE(*)","write"],["*","all_properties","RELATIONSHIP(*)","match"],["*","graph","RELATIONSHIP(*)","write"],["*","database","database","access"]]+
| +"noAccessUsers"+ | +"DENIED"+ | +[["neo4j","database","database","access"]]+
| +"publisher"+ | +"GRANTED"+ | +[["*","all_properties","NODE(*)","match"],["*","graph","NODE(*)","write"],["*","all_properties","RELATIONSHIP(*)","match"],["*","graph","RELATIONSHIP(*)","write"],["*","database","database","access"],["*","database","database","token"]]+
| +"reader"+ | +"GRANTED"+ | +[["*","all_properties","NODE(*)","match"],["*","all_properties","RELATIONSHIP(*)","match"],["*","database","database","access"]]+
| +"regularUsers"+ | +"GRANTED"+ | +[["neo4j","database","database","access"]]+
3+d|Rows: 8
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES YIELD * RETURN role, access, collect([graph, resource, segment, action]) as privileges
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The `RETURN` clause can also be used to order and paginate the results, which is useful when combined with `YIELD` and `WHERE`. In this example the query returns privileges for display five-per-page, and skips the first five to display the second page.


.Query
[source, cypher]
----
SHOW PRIVILEGES YIELD * RETURN * ORDER BY role SKIP 5 LIMIT 5
----

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +graph+ | +resource+ | +role+ | +segment+
| +"GRANTED"+ | +"match"+ | +"*"+ | +"all_properties"+ | +"admin"+ | +"RELATIONSHIP(*)"+
| +"GRANTED"+ | +"write"+ | +"*"+ | +"graph"+ | +"admin"+ | +"RELATIONSHIP(*)"+
| +"GRANTED"+ | +"transaction_management"+ | +"*"+ | +"database"+ | +"admin"+ | +"USER(*)"+
| +"GRANTED"+ | +"access"+ | +"*"+ | +"database"+ | +"admin"+ | +"database"+
| +"GRANTED"+ | +"constraint"+ | +"*"+ | +"database"+ | +"admin"+ | +"database"+
6+d|Rows: 5
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES YIELD * RETURN * ORDER BY role SKIP 5 LIMIT 5
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Available privileges can also be output as Cypher commands, by appending `AS COMMAND[S]` to the show command.


.Query
[source, cypher]
----
SHOW PRIVILEGES AS COMMANDS
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"DENY ACCESS ON DATABASE `neo4j` TO `noAccessUsers`"+
| +"GRANT ACCESS ON DATABASE * TO `admin`"+
| +"GRANT ACCESS ON DATABASE * TO `architect`"+
| +"GRANT ACCESS ON DATABASE * TO `editor`"+
| +"GRANT ACCESS ON DATABASE * TO `publisher`"+
| +"GRANT ACCESS ON DATABASE * TO `reader`"+
| +"GRANT ACCESS ON DATABASE `neo4j` TO `regularUsers`"+
| +"GRANT ACCESS ON HOME DATABASE TO `PUBLIC`"+
| +"GRANT ALL DBMS PRIVILEGES ON DBMS TO `admin`"+
| +"GRANT CONSTRAINT MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT CONSTRAINT MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT EXECUTE FUNCTION * ON DBMS TO `PUBLIC`"+
| +"GRANT EXECUTE PROCEDURE * ON DBMS TO `PUBLIC`"+
| +"GRANT INDEX MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT INDEX MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `admin`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `architect`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `editor`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `publisher`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `reader`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `admin`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `architect`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `editor`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `publisher`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `reader`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `publisher`"+
| +"GRANT START ON DATABASE * TO `admin`"+
| +"GRANT STOP ON DATABASE * TO `admin`"+
| +"GRANT TRANSACTION MANAGEMENT (*) ON DATABASE * TO `admin`"+
| +"GRANT WRITE ON GRAPH * TO `admin`"+
| +"GRANT WRITE ON GRAPH * TO `architect`"+
| +"GRANT WRITE ON GRAPH * TO `editor`"+
| +"GRANT WRITE ON GRAPH * TO `publisher`"+
1+d|Rows: 35
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES AS COMMANDS
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Like other `SHOW` commands, the output can also be processed using `YIELD` / `WHERE` / `RETURN`.


.Query
[source, cypher]
----
SHOW PRIVILEGES AS COMMANDS WHERE command CONTAINS 'MANAGEMENT'
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"GRANT CONSTRAINT MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT CONSTRAINT MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT INDEX MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT INDEX MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `architect`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `publisher`"+
| +"GRANT TRANSACTION MANAGEMENT (*) ON DATABASE * TO `admin`"+
1+d|Rows: 8
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES AS COMMANDS WHERE command CONTAINS 'MANAGEMENT'
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

It is also possible to get the privilege commands formatted for revoking instead of granting or denying the privileges.
For more info about revoking privileges, please see <<administration-security-subgraph-revoke, The REVOKE command>>.


.Query
[source, cypher]
----
SHOW PRIVILEGES AS REVOKE COMMANDS
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"REVOKE DENY ACCESS ON DATABASE `neo4j` FROM `noAccessUsers`"+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `architect`"+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `editor`"+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `publisher`"+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `reader`"+
| +"REVOKE GRANT ACCESS ON DATABASE `neo4j` FROM `regularUsers`"+
| +"REVOKE GRANT ACCESS ON HOME DATABASE FROM `PUBLIC`"+
| +"REVOKE GRANT ALL DBMS PRIVILEGES ON DBMS FROM `admin`"+
| +"REVOKE GRANT CONSTRAINT MANAGEMENT ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT CONSTRAINT MANAGEMENT ON DATABASE * FROM `architect`"+
| +"REVOKE GRANT EXECUTE FUNCTION * ON DBMS FROM `PUBLIC`"+
| +"REVOKE GRANT EXECUTE PROCEDURE * ON DBMS FROM `PUBLIC`"+
| +"REVOKE GRANT INDEX MANAGEMENT ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT INDEX MANAGEMENT ON DATABASE * FROM `architect`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `admin`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `architect`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `editor`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `publisher`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `reader`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `admin`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `architect`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `editor`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `publisher`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `reader`"+
| +"REVOKE GRANT NAME MANAGEMENT ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT NAME MANAGEMENT ON DATABASE * FROM `architect`"+
| +"REVOKE GRANT NAME MANAGEMENT ON DATABASE * FROM `publisher`"+
| +"REVOKE GRANT START ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT STOP ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT TRANSACTION MANAGEMENT (*) ON DATABASE * FROM `admin`"+
| +"REVOKE GRANT WRITE ON GRAPH * FROM `admin`"+
| +"REVOKE GRANT WRITE ON GRAPH * FROM `architect`"+
| +"REVOKE GRANT WRITE ON GRAPH * FROM `editor`"+
| +"REVOKE GRANT WRITE ON GRAPH * FROM `publisher`"+
1+d|Rows: 35
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW PRIVILEGES AS REVOKE COMMANDS
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[administration-security-subgraph-show-roles]]
=== Examples for listing privileges for specific roles

Available privileges for specific roles can be displayed using `SHOW ROLE name PRIVILEGES`.

include::show-role-privileges-syntax.adoc[]


.Query
[source, cypher]
----
SHOW ROLE regularUsers PRIVILEGES
----

Lists all privileges for role `regularUsers`.

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE regularUsers PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]


.Query
[source, cypher]
----
SHOW ROLES regularUsers, noAccessUsers PRIVILEGES
----

Lists all privileges for roles `regularUsers` and `noAccessUsers`.

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"noAccessUsers"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 2
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLES regularUsers, noAccessUsers PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Similar to the other show privilege commands, the available privileges for roles can also be output as Cypher commands with the optional `AS COMMAND[S]`.


.Query
[source, cypher]
----
SHOW ROLE admin PRIVILEGES AS COMMANDS
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"GRANT ACCESS ON DATABASE * TO `admin`"+
| +"GRANT ALL DBMS PRIVILEGES ON DBMS TO `admin`"+
| +"GRANT CONSTRAINT MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT INDEX MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `admin`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `admin`"+
| +"GRANT NAME MANAGEMENT ON DATABASE * TO `admin`"+
| +"GRANT START ON DATABASE * TO `admin`"+
| +"GRANT STOP ON DATABASE * TO `admin`"+
| +"GRANT TRANSACTION MANAGEMENT (*) ON DATABASE * TO `admin`"+
| +"GRANT WRITE ON GRAPH * TO `admin`"+
1+d|Rows: 11
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE admin PRIVILEGES AS COMMANDS
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The output can be processed using `YIELD` / `WHERE` / `RETURN` here as well.


.Query
[source, cypher]
----
SHOW ROLE architect PRIVILEGES AS COMMANDS WHERE command CONTAINS 'MATCH'
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"GRANT MATCH {*} ON GRAPH * NODE * TO `architect`"+
| +"GRANT MATCH {*} ON GRAPH * RELATIONSHIP * TO `architect`"+
1+d|Rows: 2
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE architect PRIVILEGES AS COMMANDS WHERE command CONTAINS 'MATCH'
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Again, is it possible to get the privilege commands formatted for revoking instead of granting or denying the privileges.
For more info about revoking privileges, please see <<administration-security-subgraph-revoke, The REVOKE command>>.


.Query
[source, cypher]
----
SHOW ROLE reader PRIVILEGES AS REVOKE COMMANDS
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"REVOKE GRANT ACCESS ON DATABASE * FROM `reader`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * NODE * FROM `reader`"+
| +"REVOKE GRANT MATCH {*} ON GRAPH * RELATIONSHIP * FROM `reader`"+
1+d|Rows: 3
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE reader PRIVILEGES AS REVOKE COMMANDS
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[administration-security-subgraph-show-users]]
=== Examples for listing privileges for specific users

Available privileges for specific users can be displayed using `SHOW USER name PRIVILEGES`.

[NOTE]
====
Please note that if a non-native auth provider like LDAP is in use, `SHOW USER PRIVILEGES` will only work in a limited capacity; It is only possible for a user to show their own privileges. Other users' privileges cannot be listed when using a non-native auth provider.


====

include::show-user-privileges-syntax.adoc[]


.Query
[source, cypher]
----
SHOW USER jake PRIVILEGES
----

Lists all privileges for user `jake`.

.Result
[role="queryresult",options="header,footer",cols="7*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+ | +user+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"FUNCTION(*)"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"PROCEDURE(*)"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"DEFAULT"+ | +"database"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+ | +"jake"+
7+d|Rows: 4
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW USER jake PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]


.Query
[source, cypher]
----
SHOW USERS jake, joe PRIVILEGES
----

Lists all privileges for users `jake` and `joe`.

.Result
[role="queryresult",options="header,footer",cols="7*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+ | +user+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"FUNCTION(*)"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"PROCEDURE(*)"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"DEFAULT"+ | +"database"+ | +"PUBLIC"+ | +"jake"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+ | +"jake"+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"FUNCTION(*)"+ | +"PUBLIC"+ | +"joe"+
| +"GRANTED"+ | +"execute"+ | +"database"+ | +"*"+ | +"PROCEDURE(*)"+ | +"PUBLIC"+ | +"joe"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"DEFAULT"+ | +"database"+ | +"PUBLIC"+ | +"joe"+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"noAccessUsers"+ | +"joe"+
7+d|Rows: 8
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW USERS jake, joe PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The same command can be used at all times to review available privileges for the current user. For this purpose, a shorter form of the the command also exists: SHOW USER PRIVILEGES.


.Query
[source, cypher]
----
SHOW USER PRIVILEGES
----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW USER PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

As for the other privilege commands, available privileges for users can also be output as Cypher commands with the optional `AS COMMAND[S]`.

[NOTE]
====
When showing _user_ privileges as commands, the roles in the Cypher commands are replaced with a parameter. This can be used to quickly create new roles based on the privileges of specific users.


====


.Query
[source, cypher]
----
SHOW USER jake PRIVILEGES AS COMMANDS
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"GRANT ACCESS ON DATABASE `neo4j` TO $role"+
| +"GRANT ACCESS ON HOME DATABASE TO $role"+
| +"GRANT EXECUTE FUNCTION * ON DBMS TO $role"+
| +"GRANT EXECUTE PROCEDURE * ON DBMS TO $role"+
1+d|Rows: 4
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW USER jake PRIVILEGES AS COMMANDS
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Like other `SHOW` commands, the output can also be processed using `YIELD` / `WHERE` / `RETURN`. Additionally, similar to the other show privilege commands, it is also possible to show the commands for revoking the privileges.


.Query
[source, cypher]
----
SHOW USER jake PRIVILEGES AS REVOKE COMMANDS WHERE command CONTAINS 'EXECUTE'
----

.Result
[role="queryresult",options="header,footer",cols="1*<m"]
|===
| +command+
| +"REVOKE GRANT EXECUTE FUNCTION * ON DBMS FROM $role"+
| +"REVOKE GRANT EXECUTE PROCEDURE * ON DBMS FROM $role"+
1+d|Rows: 2
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW USER jake PRIVILEGES AS REVOKE COMMANDS WHERE command CONTAINS 'EXECUTE'
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-subgraph-revoke]]
== The `REVOKE` command

Privileges that were granted or denied earlier can be revoked using the `REVOKE` command. 

include::revoke-syntax.adoc[]

An example usage of the `REVOKE` command is given here:


.Query
[source, cypher]
----
REVOKE GRANT TRAVERSE ON HOME GRAPH NODES Post FROM regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
REVOKE GRANT TRAVERSE ON HOME GRAPH NODES Post FROM regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

While it can be explicitly specified that revoke should remove a `GRANT` or `DENY`, it is also possible to revoke either one by not specifying at all as the next example demonstrates.
Because of this, if there happen to be a `GRANT` and a `DENY` on the same privilege, it would remove both.


.Query
[source, cypher]
----
REVOKE TRAVERSE ON HOME GRAPH NODES Payments FROM regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 2

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE USER joe SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
GRANT ROLE regularUsers TO jake
GRANT ROLE noAccessUsers TO joe
GRANT ACCESS ON DATABASE neo4j TO regularUsers
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
REVOKE TRAVERSE ON HOME GRAPH NODES Payments FROM regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

